import { describe, expect, test } from '@jest/globals';
import { Graph } from '../dacc/graph/graph';
describe('Graph', () => {
    test('should add and retrieve nodes', () => {
        const graph = new Graph();
        const node = { id: '1', parents: [] };
        graph.add(node);
        expect(graph.nodes.get('1')).toEqual(node);
    });
    test('should update nodes', () => {
        const graph = new Graph();
        const node = { id: '1', parents: [], value: 'test' };
        graph.add(node);
        const updatedNode = { id: '1', parents: [], value: "updated" };
        graph.update('1', updatedNode);
        expect(graph.nodes.get('1')).toEqual(updatedNode);
    });
    test('should throw error when updating non-existent node', () => {
        const graph = new Graph();
        const node = { id: '1', parents: [] };
        expect(() => graph.update('1', node)).toThrow('Node not found: 1');
    });
    test('should perform topological sort on acyclic graph', () => {
        const graph = new Graph();
        graph.add({ id: '1', parents: [] });
        graph.add({ id: '3', parents: ['2'] });
        graph.add({ id: '4', parents: ['3', '1'] });
        graph.add({ id: '2', parents: ['1'] });
        graph.add({ id: '5', parents: ['4', '3'] });
        const sorted = graph.sort();
        expect(sorted.map(n => n.id)).toEqual(['1', '2', '3', '4', '5']);
    });
    test('should detect cycles in graph', () => {
        const graph = new Graph();
        graph.add({ id: '1', parents: ['3'] });
        graph.add({ id: '2', parents: ['1'] });
        graph.add({ id: '3', parents: ['2'] });
        expect(() => graph.sort()).toThrow(/Cycle detected:/);
    });
    test('should handle empty graph', () => {
        const graph = new Graph();
        expect(graph.sort()).toEqual([]);
    });
    test('should handle graph with single node', () => {
        const graph = new Graph();
        const node = { id: '1', parents: [], value: "1" };
        graph.add(node);
        expect(graph.sort()).toEqual([node]);
    });
    test('should handle graph with multiple independent nodes', () => {
        const graph = new Graph();
        const node1 = { id: '1', parents: [] };
        const node2 = { id: '2', parents: [] };
        graph.add(node1);
        graph.add(node2);
        const sorted = graph.sort();
        expect(sorted).toHaveLength(2);
        expect(sorted).toContain(node1);
        expect(sorted).toContain(node2);
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ3JhcGgudGVzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImdyYXBoLnRlc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZELE9BQU8sRUFBRSxLQUFLLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQVE1QyxRQUFRLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRTtJQUNuQixJQUFJLENBQUMsK0JBQStCLEVBQUUsR0FBRyxFQUFFO1FBQ3ZDLE1BQU0sS0FBSyxHQUFHLElBQUksS0FBSyxFQUFZLENBQUM7UUFDcEMsTUFBTSxJQUFJLEdBQWEsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUUsQ0FBQztRQUNoRCxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ2hCLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMvQyxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksQ0FBQyxxQkFBcUIsRUFBRSxHQUFHLEVBQUU7UUFDN0IsTUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLEVBQVksQ0FBQztRQUNwQyxNQUFNLElBQUksR0FBYSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLENBQUM7UUFDL0QsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNoQixNQUFNLFdBQVcsR0FBYSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLENBQUM7UUFDekUsS0FBSyxDQUFDLE1BQU0sQ0FBQyxHQUFHLEVBQUUsV0FBVyxDQUFDLENBQUM7UUFD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Y3QsIHRlc3QgfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCB7IEdyYXBoIH0gZnJvbSAnLi4vZGFjYy9ncmFwaC9ncmFwaCc7XG5cbmludGVyZmFjZSBUZXN0Tm9kZSB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBwYXJlbnRzOiBzdHJpbmdbXTtcbiAgICB2YWx1ZT86IHN0cmluZztcbn1cblxuZGVzY3JpYmUoJ0dyYXBoJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBhZGQgYW5kIHJldHJpZXZlIG5vZGVzJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBncmFwaCA9IG5ldyBHcmFwaDxUZXN0Tm9kZT4oKTtcbiAgICAgICAgY29uc3Qgbm9kZTogVGVzdE5vZGUgPSB7IGlkOiAnMScsIHBhcmVudHM6IFtdIH07XG4gICAgICAgIGdyYXBoLmFkZChub2RlKTtcbiAgICAgICAgZXhwZWN0KGdyYXBoLm5vZGVzLmdldCgnMScpKS50b0VxdWFsKG5vZGUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHVwZGF0ZSBub2RlcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgZ3JhcGggPSBuZXcgR3JhcGg8VGVzdE5vZGU+KCk7XG4gICAgICAgIGNvbnN0IG5vZGU6IFRlc3ROb2RlID0geyBpZDogJzEnLCBwYXJlbnRzOiBbXSwgdmFsdWU6ICd0ZXN0JyB9O1xuICAgICAgICBncmFwaC5hZGQobm9kZSk7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWROb2RlOiBUZXN0Tm9kZSA9IHsgaWQ6ICcxJywgcGFyZW50czogW10sIHZhbHVlOiBcInVwZGF0ZWRcIiB9O1xuICAgICAgICBncmFwaC51cGRhdGUoJzEnLCB1cGRhdGVkTm9kZSk7XG4gICAgICAgIGV4cGVjdChncmFwaC5ub2Rlcy5nZXQoJzEnKSkudG9FcXVhbCh1cGRhdGVkTm9kZSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgdGhyb3cgZXJyb3Igd2hlbiB1cGRhdGluZyBub24tZXhpc3RlbnQgbm9kZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgZ3JhcGggPSBuZXcgR3JhcGg8VGVzdE5vZGU+KCk7XG4gICAgICAgIGNvbnN0IG5vZGU6IFRlc3ROb2RlID0geyBpZDogJzEnLCBwYXJlbnRzOiBbXSB9O1xuICAgICAgICBleHBlY3QoKCkgPT4gZ3JhcGgudXBkYXRlKCcxJywgbm9kZSkpLnRvVGhyb3coJ05vZGUgbm90IGZvdW5kOiAxJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcGVyZm9ybSB0b3BvbG9naWNhbCBzb3J0IG9uIGFjeWNsaWMgZ3JhcGgnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGdyYXBoID0gbmV3IEdyYXBoPFRlc3ROb2RlPigpO1xuICAgICAgICBncmFwaC5hZGQoeyBpZDogJzEnLCBwYXJlbnRzOiBbXSB9KTtcbiAgICAgICAgZ3JhcGguYWRkKHsgaWQ6ICczJywgcGFyZW50czogWycyJ10gfSk7XG4gICAgICAgIGdyYXBoLmFkZCh7IGlkOiAnNCcsIHBhcmVudHM6IFsnMycsICcxJ10gfSk7XG4gICAgICAgIGdyYXBoLmFkZCh7IGlkOiAnMicsIHBhcmVudHM6IFsnMSddIH0pO1xuICAgICAgICBncmFwaC5hZGQoeyBpZDogJzUnLCBwYXJlbnRzOiBbJzQnLCAnMyddIH0pO1xuXG4gICAgICAgIGNvbnN0IHNvcnRlZCA9IGdyYXBoLnNvcnQoKTtcbiAgICAgICAgZXhwZWN0KHNvcnRlZC5tYXAobiA9PiBuLmlkKSkudG9FcXVhbChbJzEnLCAnMicsICczJywgJzQnLCAnNSddKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBkZXRlY3QgY3ljbGVzIGluIGdyYXBoJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBncmFwaCA9IG5ldyBHcmFwaDxUZXN0Tm9kZT4oKTtcbiAgICAgICAgZ3JhcGguYWRkKHsgaWQ6ICcxJywgcGFyZW50czogWyczJ10gfSk7XG4gICAgICAgIGdyYXBoLmFkZCh7IGlkOiAnMicsIHBhcmVudHM6IFsnMSddIH0pO1xuICAgICAgICBncmFwaC5hZGQoeyBpZDogJzMnLCBwYXJlbnRzOiBbJzInXSB9KTtcblxuICAgICAgICBleHBlY3QoKCkgPT4gZ3JhcGguc29ydCgpKS50b1Rocm93KC9DeWNsZSBkZXRlY3RlZDovKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgZ3JhcGgnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGdyYXBoID0gbmV3IEdyYXBoPFRlc3ROb2RlPigpO1xuICAgICAgICBleHBlY3QoZ3JhcGguc29ydCgpKS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZ3JhcGggd2l0aCBzaW5nbGUgbm9kZScsICgpID0+IHtcbiAgICAgICAgY29uc3QgZ3JhcGggPSBuZXcgR3JhcGg8VGVzdE5vZGU+KCk7XG4gICAgICAgIGNvbnN0IG5vZGU6IFRlc3ROb2RlID0geyBpZDogJzEnLCBwYXJlbnRzOiBbXSwgdmFsdWU6IFwiMVwiIH07XG4gICAgICAgIGdyYXBoLmFkZChub2RlKTtcbiAgICAgICAgZXhwZWN0KGdyYXBoLnNvcnQoKSkudG9FcXVhbChbbm9kZV0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBncmFwaCB3aXRoIG11bHRpcGxlIGluZGVwZW5kZW50IG5vZGVzJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBncmFwaCA9IG5ldyBHcmFwaDxUZXN0Tm9kZT4oKTtcbiAgICAgICAgY29uc3Qgbm9kZTE6IFRlc3ROb2RlID0geyBpZDogJzEnLCBwYXJlbnRzOiBbXSB9O1xuICAgICAgICBjb25zdCBub2RlMjogVGVzdE5vZGUgPSB7IGlkOiAnMicsIHBhcmVudHM6IFtdIH07XG4gICAgICAgIGdyYXBoLmFkZChub2RlMSk7XG4gICAgICAgIGdyYXBoLmFkZChub2RlMik7XG4gICAgICAgIGNvbnN0IHNvcnRlZCA9IGdyYXBoLnNvcnQoKTtcbiAgICAgICAgZXhwZWN0KHNvcnRlZCkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgICBleHBlY3Qoc29ydGVkKS50b0NvbnRhaW4obm9kZTEpO1xuICAgICAgICBleHBlY3Qoc29ydGVkKS50b0NvbnRhaW4obm9kZTIpO1xuICAgIH0pO1xufSk7Il19